{
  "description": "SensorNet, a 4 layer NN: 784-1024-1024-1024-16",
  "nodes": [
    {"type": "dummy-data", "inputs": [], "outputs": ["data"], "config":{"name": "data", "shape": "__BATCH_SIZE__,784", "one-time": true, "data-filler": {"type": "normal", "mean": 0, "stddev": 0.01, "scale": 1}}},
    {"type": "dummy-data", "inputs": [], "outputs": ["rlabs"], "config":{"name": "labels", "shape": "__BATCH_SIZE__,1", "one-time": true, "data-filler": {"type": "uniform", "min": 0, "max": 9, "dtype": "int"}}},

    {"type": "dense", "inputs": ["data"], "outputs": ["dense1"], "config":{"name": "dense1", "input-dim":784, "output-dim":1024, "weight-filler": {"type": "normal", "mean": 0, "stddev": 0.01, "scale": 1}, "bias-filler": {"type": "constant", "value": 0}}},
    {"type": "relu", "inputs": ["dense1"], "outputs": ["relu1"], "config":{"name": "relu1", "transparent":true}},

    {"type": "dense", "inputs": ["relu1"], "outputs": ["dense2"], "config":{"name": "dense2", "input-dim":1024, "output-dim":1024, "weight-filler": {"type": "normal", "mean": 0, "stddev": 0.01, "scale": 1}, "bias-filler": {"type": "constant", "value": 0}}},
    {"type": "relu", "inputs": ["dense2"], "outputs": ["relu2"], "config":{"name": "relu2", "transparent":true}},

    {"type": "dense", "inputs": ["relu2"], "outputs": ["dense3"], "config":{"name": "dense3", "input-dim":1024, "output-dim":1024, "weight-filler": {"type": "normal", "mean": 0, "stddev": 0.01, "scale": 1}, "bias-filler": {"type": "constant", "value": 0}}},
    {"type": "relu", "inputs": ["dense3"], "outputs": ["relu3"], "config":{"name": "relu3", "transparent":true}},

    {"type": "dense", "inputs": ["relu3"], "outputs": ["dense4"], "config":{"name": "dense4", "input-dim":1024, "output-dim":16, "weight-filler": {"type": "normal", "mean": 0, "stddev": 0.01, "scale": 1}, "bias-filler": {"type": "constant", "value": 0}}},
    {"type": "one-hot-encoder", "inputs": ["rlabs"], "outputs": ["one-hot-rlabs"], "config":{"name": "one-hot-encoder", "num-classes": 16}},
    {"type": "softmax-with-cross-entropy",  "inputs": ["dense4", "one-hot-rlabs"], "outputs": ["training/probs", "training/labs", "training/error", "training/loss"], "config":{"name": "training/softmax"}},

    {"type": "softmax",  "inputs": ["dense4"], "outputs": ["inference/probs"], "config":{"name": "inference/softmax"}}
  ],
  "execution-context": [
    {
      "name": "inference",
      "forward": ["data", "dense1", "relu1", "dense2", "relu2", "dense3", "relu3", "dense4", "inference/softmax"]
    },
    {
      "name": "training",
      "forward":  ["data", "labels", "dense1", "relu1", "dense2", "relu2", "dense3", "relu3", "dense4", "one-hot-encoder", "training/softmax"],
      "backward": ["dense4", "relu3", "dense3", "relu2", "dense2", "relu1", "dense1[compute-only]"],
      "compute":  ["dense1", "dense2", "dense3", "dense4"]
    }
  ]
}
