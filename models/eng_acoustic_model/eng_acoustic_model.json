{
  "description": "A typical fully connected DNN used to implement acoustic model in hybrid HMM-DNN speech recognition systems (540-2048-2048-2048-2048-2048-8192)",
  "nodes": [
    {"type": "dummy-data", "inputs": [], "outputs": ["data"], "config":{"name": "data", "shape": "__BATCH_SIZE__,540", "one-time": true, "data-filler": {"type": "normal", "mean": 0, "stddev": 0.01, "scale": 1}}},
    {"type": "dummy-data", "inputs": [], "outputs": ["rlabs"], "config":{"name": "labels", "shape": "__BATCH_SIZE__,1", "one-time": true, "data-filler": {"type": "uniform", "min": 0, "max": 8191, "dtype": "int"}}},

    {"type": "dense", "inputs": ["data"], "outputs": ["dense1"], "config":{"name": "dense1", "input-dim":540, "output-dim":2048, "weight-filler": {"type": "normal", "mean": 0, "stddev": 0.01, "scale": 1}, "bias-filler": {"type": "constant", "value": 0}}},
    {"type": "relu", "inputs": ["dense1"], "outputs": ["relu1"], "config":{"name": "relu1", "transparent":true}},

    {"type": "dense", "inputs": ["relu1"], "outputs": ["dense2"], "config":{"name": "dense2", "input-dim":2048, "output-dim":2048, "weight-filler": {"type": "normal", "mean": 0, "stddev": 0.01, "scale": 1}, "bias-filler": {"type": "constant", "value": 0}}},
    {"type": "relu", "inputs": ["dense2"], "outputs": ["relu2"], "config":{"name": "relu2", "transparent":true}},

    {"type": "dense", "inputs": ["relu2"], "outputs": ["dense3"], "config":{"name": "dense3", "input-dim":2048, "output-dim":2048, "weight-filler": {"type": "normal", "mean": 0, "stddev": 0.01, "scale": 1}, "bias-filler": {"type": "constant", "value": 0}}},
    {"type": "relu", "inputs": ["dense3"], "outputs": ["relu3"], "config":{"name": "relu3", "transparent":true}},

    {"type": "dense", "inputs": ["relu3"], "outputs": ["dense4"], "config":{"name": "dense4", "input-dim":2048, "output-dim":2048, "weight-filler": {"type": "normal", "mean": 0, "stddev": 0.01, "scale": 1}, "bias-filler": {"type": "constant", "value": 0}}},
    {"type": "relu", "inputs": ["dense4"], "outputs": ["relu4"], "config":{"name": "relu4", "transparent":true}},

    {"type": "dense", "inputs": ["relu4"], "outputs": ["dense5"], "config":{"name": "dense5", "input-dim":2048, "output-dim":2048, "weight-filler": {"type": "normal", "mean": 0, "stddev": 0.01, "scale": 1}, "bias-filler": {"type": "constant", "value": 0}}},
    {"type": "relu", "inputs": ["dense5"], "outputs": ["relu5"], "config":{"name": "relu5", "transparent":true}},

    {"type": "dense", "inputs": ["relu5"], "outputs": ["dense6"], "config":{"name": "dense6", "input-dim":2048, "output-dim":8192, "weight-filler": {"type": "normal", "mean": 0, "stddev": 0.01, "scale": 1}, "bias-filler": {"type": "constant", "value": 0}}},
    {"type": "one-hot-encoder", "inputs": ["rlabs"], "outputs": ["one-hot-rlabs"], "config":{"name": "one-hot-encoder", "num-classes": 8192}},
    {"type": "softmax-with-cross-entropy",  "inputs": ["dense6", "one-hot-rlabs"], "outputs": ["training/probs", "training/labs", "training/error", "training/loss"], "config":{"name": "training/softmax"}},

    {"type": "softmax",  "inputs": ["dense6"], "outputs": ["inference/probs"], "config":{"name": "inference/softmax"}}
  ],
  "execution-context": [
    {
      "name": "inference",
      "forward": ["data", "dense1", "relu1", "dense2", "relu2", "dense3", "relu3", "dense4", "relu4", "dense5", "relu5", "dense6", "inference/softmax"]
    },
    {
      "name": "training",
      "forward":  ["data", "labels", "dense1", "relu1", "dense2", "relu2", "dense3", "relu3", "dense4", "relu4", "dense5", "relu5", "dense6", "one-hot-encoder", "training/softmax"],
      "backward": ["dense6", "relu5", "dense5", "relu4", "dense4", "relu3", "dense3", "relu2", "dense2", "relu1", "dense1[compute-only]"],
      "compute":  ["dense1", "dense2", "dense3", "dense4", "dense5", "dense6"]
    }
  ]
}
